{% extends "admin/login.html" %}
{% load i18n %}

{% block content %}
{{ block.super }}
<script>
  // Ensure the CSRF token is present
  document.addEventListener('DOMContentLoaded', function() {
    var form = document.getElementById('login-form');
    var csrfTokenInput = document.querySelector('input[name="csrfmiddlewaretoken"]');
    
    if (!csrfTokenInput && form) {
      console.log('CSRF token not found, creating one');
      
      // Get the CSRF token from cookies
      function getCookie(name) {
        let cookieValue = null;
        if (document.cookie && document.cookie !== '') {
          const cookies = document.cookie.split(';');
          for (let i = 0; i < cookies.length; i++) {
            const cookie = cookies[i].trim();
            if (cookie.substring(0, name.length + 1) === (name + '=')) {
              cookieValue = decodeURIComponent(cookie.substring(name.length + 1));
              break;
            }
          }
        }
        return cookieValue;
      }
      
      var csrftoken = getCookie('csrftoken');
      if (csrftoken) {
        var input = document.createElement('input');
        input.type = 'hidden';
        input.name = 'csrfmiddlewaretoken';
        input.value = csrftoken;
        form.appendChild(input);
      }
    }
  });
</script>
{% endblock %} 